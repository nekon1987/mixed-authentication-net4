<?xml version="1.0" encoding="utf-8"?>
<!--
  For more information on how to configure your ASP.NET application, please visit
  https://go.microsoft.com/fwlink/?LinkId=301880
  -->
<configuration>
  
  <configSections>
    <section name="system.identityModel" type="System.IdentityModel.Configuration.SystemIdentityModelSection, System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net" />
  </configSections>
  <appSettings>
    <add key="webpages:Version" value="3.0.0.0" />
    <add key="webpages:Enabled" value="false" />
    <add key="ClientValidationEnabled" value="true" />
    <add key="UnobtrusiveJavaScriptEnabled" value="true" />
    <add key="ida:ADFSMetadata" value="https://mortycorp-dc.mortycorp.local/federationmetadata/2007-06/federationmetadata.xml" />
    <add key="ida:Wtrealm" value="https://gy-gd-k120/MortysAwesomeClientApp" />
  </appSettings>
  <log4net>
      <appender name="LogFileAppender" type="log4net.Appender.RollingFileAppender">
      <param name="File" value="MyFirstLogger.log" />
      <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
      <appendToFile value="true" />
      <rollingStyle value="Size" />
      <maxSizeRollBackups value="2" />
      <maximumFileSize value="1MB" />
      <staticLogFileName value="true" />
      <layout type="log4net.Layout.PatternLayout">
              <param name="ConversionPattern" value="%d [%t] %-5p %c %m%n" />
      </layout>
  </appender>

    <root>
        <level value="ALL" />
        <appender-ref ref="LogFileAppender" />
    </root>
  </log4net>
  <system.web>
    <compilation debug="true" targetFramework="4.7.2" />
    <httpRuntime targetFramework="4.7.2" />
  </system.web>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.IdentityModel.Protocols.WsFederation" publicKeyToken="31BF3856AD364E35" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-5.2.1.0" newVersion="5.2.1.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.IdentityModel.Tokens.Saml" publicKeyToken="31BF3856AD364E35" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-5.2.1.0" newVersion="5.2.1.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.IdentityModel.Tokens" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-5.2.1.0" newVersion="5.2.1.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.IdentityModel.Protocols.OpenIdConnect" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-5.2.1.0" newVersion="5.2.1.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.IdentityModel.Protocols" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-5.2.1.0" newVersion="5.2.1.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.IdentityModel.Tokens.Jwt" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-5.2.1.0" newVersion="5.2.1.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Antlr3.Runtime" publicKeyToken="eb42632606e9261f" />
        <bindingRedirect oldVersion="0.0.0.0-3.5.0.2" newVersion="3.5.0.2" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Optimization" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-1.1.0.0" newVersion="1.1.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="WebGrease" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-1.6.5135.21930" newVersion="1.6.5135.21930" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" />
        <bindingRedirect oldVersion="0.0.0.0-11.0.0.0" newVersion="11.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-3.0.0.0" newVersion="3.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-5.2.7.0" newVersion="5.2.7.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-3.0.0.0" newVersion="3.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.IdentityModel.Protocols.WsFederation" publicKeyToken="31bf3856ad364e35" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-5.2.1.0" newVersion="5.2.1.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.IdentityModel.Tokens.Saml" publicKeyToken="31bf3856ad364e35" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-5.2.1.0" newVersion="5.2.1.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
  
    
  <!--<system.identityModel>
    <identityConfiguration>
      <audienceUris>
        <add value="https://gy-gd-k120/MortysAwesomeClientApp/" />
      </audienceUris>
      --><!--Commented by Identity and Access VS Package--><!--
      --><!--<issuerNameRegistry type="System.IdentityModel.Tokens.ValidatingIssuerNameRegistry, System.IdentityModel.Tokens.ValidatingIssuerNameRegistry"><authority name="http://sts.contoso.com/adfs/services/trust"><keys><add thumbprint="1a5a0a3460d8e9cbd7738b921bb4aba5aecba8ee" /></keys><validIssuers><add name="sts.contoso.com" /></validIssuers></authority></issuerNameRegistry>--><!--
      --><!--certificationValidationMode set to "None" by the the Identity and Access Tool for Visual Studio. For development purposes.--><!--
      <certificateValidation certificateValidationMode="None" />
      --><!--Commented by Identity and Access VS Package--><!--
      --><!--<issuerNameRegistry type="System.IdentityModel.Tokens.ValidatingIssuerNameRegistry, System.IdentityModel.Tokens.ValidatingIssuerNameRegistry"><authority name="http://sts.contoso.com/adfs/services/trust"><keys><add thumbprint="â€Ž1a5a0a3460d8e9cbd7738b921bb4aba5aecba8ee" /></keys><validIssuers><add name="sts.contoso.com" /></validIssuers></authority></issuerNameRegistry>--><!--
      <issuerNameRegistry type="System.IdentityModel.Tokens.ValidatingIssuerNameRegistry, System.IdentityModel.Tokens.ValidatingIssuerNameRegistry">
        --><!--<authority name="https://mortycorp-dc.mortycorp.local/adfs/services/trust">--><!--
        <authority name="https://mortycorp-dc.mortycorp.local">
          <keys>
            <add thumbprint="350c0b0fe744ee3bc3cbbb2182ad6628692ddbab" />
            --><!--<add thumbprint="930b80add721971a219f2378a4695d28318f158a" />--><!--
          </keys>
          <validIssuers>
            --><!--<add name="https://mortycorp-dc.mortycorp.local/adfs/services/trust" />--><!--
            <add name="https://mortycorp-dc.mortycorp.local" />
          </validIssuers>
        </authority>
      </issuerNameRegistry>
      <securityTokenHandlers>
        <add type="System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
        <remove type="System.IdentityModel.Tokens.SessionSecurityTokenHandler, System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
      </securityTokenHandlers>
    </identityConfiguration>
  </system.identityModel>-->
  
  <!--<system.identityModel >
    
    <identityConfiguration saveBootstrapContext="true">
      <audienceUris>
        <add value="http://localhost/" />
      </audienceUris>
       --><!--<securityTokenHandlers>
        <clear /> --><!-- Note the CLEAR here --><!--
        <add type="System.IdentityModel.Tokens.SessionSecurityTokenHandler, System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
        </add>
                 <securityTokenHandlerConfiguration>
              --><!-- issuerNameRegistry and audienceUris used to be directly under identityConfiguration--><!--
 
              --><!-- Check this application trusts the STS.
              There's only one built in issuer name registry.--><!--
              <issuerNameRegistry 
                type="System.IdentityModel.Tokens.ConfigurationBasedIssuerNameRegistry, 
                System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
                <trustedIssuers>
                  --><!-- Checks the token is signed with an X509 certificate with this thumbprint 
                  Gives the claim issuer the name "LocalSTS" --><!--
                  <add thumbprint="12E..." name="LocalSTS" />
                </trustedIssuers>
              </issuerNameRegistry>
 
              --><!-- OPTIONAL, probably not needed. Check the signing certificate trust chain and whether it's been revoked --><!--
              --><!--<certificateValidation 
                certificateValidationMode="PeerOrChainTrust" 
                revocationMode="NoCheck" />--><!--
 
              --><!-- The realm name (URI of Relying Party) is embedded into the token. 
                To ensure the token is for this RP, use audienceUris
                Otherwise client can send token from shared STS for application A to application B (re-purposing attack). --><!--
              <audienceUris>
                <clear/>
                --><!-- same as realm, below --><!--
                <add value="http://ThisApplication/"/>
              </audienceUris>
            </securityTokenHandlerConfiguration>
      </securityTokenHandlers>--><!--
      



      <certificateValidation certificateValidationMode="PeerOrChainTrust" />
    </identityConfiguration>
  </system.identityModel>-->
      
  <system.webServer>
    <!--<validation validateIntegratedModeConfiguration="false" />-->
       <security>
      <authentication>
        <!--<anonymousAuthentication enabled="false" />-->
        <windowsAuthentication enabled="true">
          <providers>
            <clear />
            <add value="Negotiate" />
            <add value="NTLM" />
          </providers>
        </windowsAuthentication>
                <anonymousAuthentication enabled="false" />
      </authentication>
    </security> 
    
    <modules runAllManagedModulesForAllRequests="true">
      <remove name="FormsAuthenticationModule" />
      <remove name="WSFederationAuthenticationModule" />
    
      <!--<add name="SessionAuthenticationModule" type="System.IdentityModel.Services.SessionAuthenticationModule, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"></add>--> 
      <!--<add name="WsFederationAuthenticationModule" type="System.IdentityModel.Services.WSFederationAuthenticationModule, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />-->
      
      <!--<add name="AuthenticationRoutingModule" type="Morty.Security.AuthenticationRoutingModule, Morty.Security" preCondition="managedHandler" />-->

      <add name="SessionAuthenticationModule" type="Morty.Security.SessionAuthenticationModule, Morty.Security" preCondition="managedHandler" />
      <add name="WSFederationAuthenticationModule" type="Morty.Security.FederationAuthenticationModule, Morty.Security" preCondition="managedHandler" />     
    
    </modules> 
  </system.webServer>


  <system.web>
    <sessionState mode="InProc" timeout="20" />
    <httpModules>
      <remove name="FormsAuthenticationModule" />
      <remove name="WSFederationAuthenticationModule" />
      <remove name="SessionAuthenticationModule" />
      <remove name="WSFederationAuthenticationModule" />    
     </httpModules>
  </system.web>
    
  
  <system.codedom>
    <compilers>
      <compiler language="c#;cs;csharp" extension=".cs" type="Microsoft.CodeDom.Providers.DotNetCompilerPlatform.CSharpCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" warningLevel="4" compilerOptions="/langversion:default /nowarn:1659;1699;1701" />
      <compiler language="vb;vbs;visualbasic;vbscript" extension=".vb" type="Microsoft.CodeDom.Providers.DotNetCompilerPlatform.VBCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" warningLevel="4" compilerOptions="/langversion:default /nowarn:41008 /define:_MYTYPE=\&quot;Web\&quot; /optionInfer+" />
    </compilers>
  </system.codedom>
</configuration>